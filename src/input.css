@import "tailwindcss";
@plugin "@tailwindcss/typography";

@custom-variant dark {
    &:where(.dark *),
    &:where([data-theme="dark"] *) {
        @slot;
    }
}

@custom-variant paper {
    &:where([data-theme="paper"] *) {
        @slot;
    }
}

/* Add paragraph spacing styles */
.whitespace-pre-line {
    white-space: pre-line;
}

.whitespace-pre-line br {
    content: "";
    display: block;
    margin-bottom: 1.5em;
}

li {
    text-indent: 0;
    margin-left: 20px;
}

@media (min-width: 768px) {
    li {
        margin-left: 80px;
    }
}

:where(.dark) body,
:where([data-theme="dark"]) body {
    --tw-bg-opacity: 1;
    background-color: rgb(0 0 0 / var(--tw-bg-opacity));
}

@layer base {
    :root {
        --pencil-lite-filter: url("#pencil-lite-filter");
    }

    .pencil-lite {
        filter: var(--pencil-lite-filter, contrast(1.02) saturate(0.96));
        -webkit-filter: var(--pencil-lite-filter, contrast(1.02) saturate(0.96));
    }

    @supports not (filter: url("#pencil-lite-filter")) {
        .pencil-lite {
            filter: contrast(1.02) saturate(0.96);
            -webkit-filter: contrast(1.02) saturate(0.96);
            text-shadow: 0.5px 0.5px 0 rgba(0, 0, 0, 0.08);
        }
    }

    [data-theme="paper"] {
        background-color: #fdf6e3;
        color: #1f2937;
        --paper-texture: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0MDAgNDAwIj4KICA8ZmlsdGVyIGlkPSJwYXBlciI+CiAgICA8ZmVUdXJidWxlbmNlIHR5cGU9ImZyYWN0YWxOb2lzZSIgYmFzZUZyZXF1ZW5jeT0iMC43NSIgbnVtT2N0YXZlcz0iNCIgc2VlZD0iMiIgc3RpdGNoVGlsZXM9InN0aXRjaCIgcmVzdWx0PSJiYXNlIi8+CiAgICA8ZmVEaWZmdXNlTGlnaHRpbmcgaW49ImJhc2UiIGxpZ2h0aW5nLWNvbG9yPSIjZmVmZGY4IiBzdXJmYWNlU2NhbGU9IjEuMiIgcmVzdWx0PSJsaWdodCI+CiAgICAgIDxmZURpc3RhbnRMaWdodCBhemltdXRoPSIxMzUiIGVsZXZhdGlvbj0iNTUiLz4KICAgIDwvZmVEaWZmdXNlTGlnaHRpbmc+CiAgICA8ZmVDb21wb3NpdGUgaW49ImxpZ2h0IiBpbjI9ImJhc2UiIG9wZXJhdG9yPSJhcml0aG1ldGljIiBrMT0iMC42IiBrMj0iMC44IiBrMz0iMC4yIiByZXN1bHQ9InBhcGVyIi8+CiAgICA8ZmVUdXJidWxlbmNlIHR5cGU9ImZyYWN0YWxOb2lzZSIgYmFzZUZyZXF1ZW5jeT0iMC4wNSIgbnVtT2N0YXZlcz0iMiIgc2VlZD0iOCIgc3RpdGNoVGlsZXM9InN0aXRjaCIgcmVzdWx0PSJmaWJlcnMiLz4KICAgIDxmZUNvbG9yTWF0cml4IGluPSJmaWJlcnMiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIxIDAgMCAwIDAgIDAgMSAwIDAgMCAgMCAwIDEgMCAwICAwIDAgMCAwLjYgMCIgcmVzdWx0PSJmaWJlcnNUb25lIi8+CiAgICA8ZmVCbGVuZCBpbj0icGFwZXIiIGluMj0iZmliZXJzVG9uZSIgbW9kZT0ic29mdC1saWdodCIgcmVzdWx0PSJ0ZXh0dXJlIi8+CiAgPC9maWx0ZXI+CiAgPHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsdGVyPSJ1cmwoI3BhcGVyKSIgb3BhY2l0eT0iMC45Ii8+Cjwvc3ZnPgo=");
    }

    [data-theme="paper"] body {
        background-color: #fdf6e3;
        color: #1f2937;
        background-image:
            radial-gradient(1200px at 30% 18%, rgba(255, 255, 255, 0.6), rgba(253, 246, 227, 0)),
            radial-gradient(900px at 82% 8%, rgba(255, 255, 255, 0.38), rgba(253, 246, 227, 0)),
            linear-gradient(
                160deg,
                rgba(236, 221, 193, 0.32) 0%,
                rgba(236, 221, 193, 0.14) 32%,
                rgba(217, 197, 158, 0.08) 100%
            ),
            var(--paper-texture);
        background-size: 100% 100%, 100% 100%, 100% 100%, 420px 420px;
        background-blend-mode: screen, soft-light, multiply, normal;
        box-shadow: inset 0 0 48px rgba(17, 24, 39, 0.05);
    }

    [data-theme="paper"] .prose,
    [data-theme="paper"] .paper\:prose {
        --tw-prose-body: #1f2937;
        --tw-prose-headings: #111827;
        --tw-prose-links: #111827;
        --tw-prose-bold: #111827;
        --tw-prose-counters: #4b5563;
        --tw-prose-bullets: #4b5563;
        --tw-prose-hr: #e4d5b2;
        --tw-prose-quotes: #1f2937;
        --tw-prose-quote-borders: #d4c29a;
        --tw-prose-captions: #4b5563;
        --tw-prose-code: #111827;
        --tw-prose-pre-code: #111827;
        --tw-prose-pre-bg: #f0e6cf;
    }

    [data-theme="paper"] button,
    [data-theme="paper"] button:hover,
    [data-theme="paper"] button:focus {
        background-color: transparent !important;
        color: #111827 !important;
    }
}

@layer utilities {
    @keyframes toast-in {
        from {
            opacity: 0;
            transform: translateY(32px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes toast-out {
        from {
            opacity: 1;
            transform: translateY(0);
        }

        to {
            opacity: 0;
            transform: translateY(-32px);
        }
    }

    .toast-animate-in {
        animation: toast-in 0.4s cubic-bezier(0.4, 0, 0.2, 1) both;
        will-change: opacity, transform;
    }

    .toast-animate-out {
        animation: toast-out 0.4s cubic-bezier(0.4, 0, 0.2, 1) both;
        will-change: opacity, transform;
    }

    @keyframes fadein-choices {
        from {
            opacity: 0;
        }

        to {
            opacity: 1;
        }
    }

    .animate-fadein-choices {
        animation: fadein-choices 1s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        will-change: opacity, transform;
    }
}

@layer components {
    .journal-page {
        @apply relative mx-auto max-w-2xl p-10 rounded-lg shadow-lg bg-[#f9f6ee]
               bg-[radial-gradient(rgba(0,0,0,0.04)_1px,transparent_1px),radial-gradient(rgba(0,0,0,0.03)_1px,transparent_1px)]
               bg-[length:3px_3px,6px_6px] text-stone-700;
    }

    .journal-page::before {
        content: "";
        @apply absolute top-6 bottom-6 left-8 w-px bg-red-400 opacity-80;
    }

    .journal-lines {
        @apply relative pl-10 pr-3 py-2;
        background-image: linear-gradient(to bottom, rgba(120,110,90,0.18) 1px, transparent 1px);
        background-size: 100% 1.8rem;
    }

    .journal-choice {
        @apply flex items-center gap-2 px-4 py-2 rounded-full cursor-pointer
               bg-white/70 shadow-sm hover:shadow-md hover:bg-white transition;
    }

    .journal-choice-index {
        @apply font-semibold text-sm text-orange-700;
    }

    /* 深色模式 */
    .dark .journal-page {
        @apply bg-[#26231f] text-[#f1e8d8];
        background-image: radial-gradient(rgba(255,255,255,0.04)_1px,transparent_1px),
                           radial-gradient(rgba(255,255,255,0.03)_1px,transparent_1px);
        background-size: 3px 3px, 6px 6px;
    }

    .dark .journal-lines {
        background-image: linear-gradient(to bottom, rgba(255,255,255,0.18) 1px, transparent 1px);
    }

    .dark .journal-choice {
        @apply bg-neutral-800/80 text-[#f3e9db];
    }
}
